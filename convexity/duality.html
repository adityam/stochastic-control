<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aditya Mahajan">
<meta name="dcterms.date" content="2023-09-19">
<meta name="description" content="ECES 506 (Stochastic Control and Decision Theory)">

<title>Course Notes - 41&nbsp; Duality</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../references.html" rel="next">
<link href="../convexity/convexity.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../site_libs/quarto-contrib/nutshell-1.0.6/nutshell.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script>
window.MathJax = {
  tex: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: true,
    tags: "ams",
    macros: {
      PR: "\\mathbb{P}",
      EXP: "\\mathbb{E}",
      IND: "\\mathbb{I}",
      ONES: "\\mathbb{1}",
      reals: "\\mathbb{R}",
      integers: "\\mathbb{Z}",
      BLANK: "\\mathfrak{E}",
      TRANS: "\\intercal",
      BELLMAN: "\\mathcal{B}",
      RICCATI: "\\mathcal{R}",
      GAIN: "\\mathcal{G}",
      GREEDY: "\\mathcal{G}",
      MISMATCH: "\\mathcal{D}",
      VEC: "\\operatorname{vec}",
      diag: "\\operatorname{diag}",
      ROWS: "\\operatorname{vec}",
      TR: "\\operatorname{Tr}",   
      SPAN: "\\operatorname{sp}",   
      DRE: "\\operatorname{DRE}",   
      DARE: "\\operatorname{DARE}",   
      LQR: "\\operatorname{LQR}",   
      ALPHABET: ["\\mathcal{#1}", 1],
      MATRIX: ["\\begin{bmatrix} #1 \\end{bmatrix}", 1],
      NORM: ["\\left\\lVert \\mathstrut #1 \\right\\rVert", 1],
      ABS: ["\\left\\lvert \\mathstrut #1 \\right\\rvert", 1],
      GRAD: "\\nabla"
    },
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
};
</script>
<script async="" data-id="101261731" src="//static.getclicky.com/js"></script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../stochastic-control/index.html" rel="" target="">
 <span class="menu-text">Stochastic Control</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../multi-agent-systems/index.html" rel="" target="">
 <span class="menu-text">Multi-Agent Systems</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto tools-wide">
    <a href="https://github.com/adityam/stochastic-control" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../convexity/convexity.html">Convexity Appendix</a></li><li class="breadcrumb-item"><a href="../convexity/duality.html"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Duality</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the course</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Stochastic Optimization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stochastic-optimization/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stochastic-optimization/newsvendor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The newsvendor problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stochastic-optimization/certainty-equivalence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Certainty equivalence</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">MDPs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Finite horizon MDPs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/gambling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Optimal gambling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/inventory-management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Inventory Management</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/monotone-mdps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Monotonicity of value function and optimal policies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/power-delay-tradeoff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Power-delay tradeoff in wireless communication</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/reward-shaping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Reward Shaping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/optimal-stopping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Optimal stopping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/inf-horizon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Infinite horizon MDPs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/mdp-algorithms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">MDP algorithms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/inventory-management-revisited.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Inventory management (revisted)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/mobile-edge-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Service Migration in Mobile edge computing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/computational-complexity-vi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Computational complexity of value interation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/martingale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Thirfty and equalizing policies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/linear-programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Linear programming formulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/lipschitz-mdps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Lipschitz MDPs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/periodic-mdps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Periodic MDPs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">POMDPs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pomdps/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pomdps/sequential-hypothesis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Sequential hypothesis testing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Approx DP</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../approx-mdps/approx-DP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Approximate dynamic programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../approx-mdps/policy-loss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Upper bounds on policy loss</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../approx-mdps/model-approximation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Model approximation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Risk sensitive MDPs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../risk-sensitive/risk-sensitive-utility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Risk Sensitive Utility</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../risk-sensitive/risk-sensitive-mdps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Risk Sensitive MDPs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Linear systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-systems/lqr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Linear quadratic regulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-systems/large-scale-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Large scale systems</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">RL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rl/stochastic-approximation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Stochastic approximation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">Probability Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/convergence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Convergence of random variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/sub-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Sub-Gaussian random variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/change-of-measure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Change of Measure</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/martingales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Martingales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/IPM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Integral Probablity Metrics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/stochastic-stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Stochastic stability</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">Linear Algebra Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-algebra/matrix-relationships.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Some useful matrix relationships</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-algebra/positive-definite-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Positive definite matrices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-algebra/svd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Singular value decomposition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-algebra/rkhs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Reproducing Kernel Hilbert Space</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
 <span class="menu-text">Convexity Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../convexity/convexity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Convex sets and convex functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../convexity/duality.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Duality</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 1</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#basic-intuition" id="toc-basic-intuition" class="nav-link active" data-scroll-target="#basic-intuition"><span class="header-section-number">41.1</span> Basic Intuition</a></li>
  <li><a href="#general-definition" id="toc-general-definition" class="nav-link" data-scroll-target="#general-definition"><span class="header-section-number">41.2</span> General definition</a></li>
  <li><a href="#properties-of-legendre-fenchel-transform" id="toc-properties-of-legendre-fenchel-transform" class="nav-link" data-scroll-target="#properties-of-legendre-fenchel-transform"><span class="header-section-number">41.3</span> Properties of Legendre-Fenchel transform</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/adityam/stochastic-control/edit/quarto/convexity/duality.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Duality</span></h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="http://www.cim.mcgill.ca/~adityam">Aditya Mahajan</a> </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="http://www.mcgill.ca/ece">
            McGill University
            </a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Updated</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 19, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="basic-intuition" class="level2 page-columns page-full" data-number="41.1">
<h2 data-number="41.1" class="anchored" data-anchor-id="basic-intuition"><span class="header-section-number">41.1</span> Basic Intuition</h2>
<p>We start by stating a <a href="https://proofwiki.org/wiki/Convex_Real_Function_is_Pointwise_Supremum_of_Affine_Functions">basic fact</a></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Characterization of convex functions
</div>
</div>
<div class="callout-body-container callout-body">
<p>Any convex function can be represented as a pointwise supremum of convex functions. More formally, for any convex <span class="math inline">\(f \colon \reals^n \to \reals\)</span>, there exists a <em>countable</em> index set <span class="math inline">\(I\)</span> and a family of <span class="math inline">\(\{a_i \in \reals^n\}_{i \in I}\)</span> and <span class="math inline">\(\{b_i \in \reals\}_{i \in I}\)</span> such that <span class="math display">\[
  f(x) = \sup_{i \in I} \{ a_i^\TRANS x + b_i \}
\]</span></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="21" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 20;"><span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>Smax <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>np <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">function</span>(s) { <span class="cf">return</span> s<span class="op">*</span>s <span class="op">+</span> <span class="dv">1</span> }</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">// Legendre transform of f</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> <span class="kw">function</span>(s) { <span class="cf">return</span> s<span class="op">*</span>s<span class="op">/</span><span class="dv">4</span> <span class="op">-</span> <span class="dv">1</span> }</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>points <span class="op">=</span> {</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> points <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>()</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> idx <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>( <span class="kw">var</span> i <span class="op">=</span> <span class="op">-</span>n <span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> s <span class="op">=</span> Smax<span class="op">*</span>i<span class="op">/</span>n</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    points[idx<span class="op">++</span>] <span class="op">=</span> { <span class="dt">point</span><span class="op">:</span> s<span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">f</span>(s) }</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> points</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>legendre <span class="op">=</span> {</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> points <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>()</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> idx <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>( <span class="kw">var</span> i <span class="op">=</span> <span class="op">-</span>np<span class="op">;</span> i <span class="op">&lt;=</span> np<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> p <span class="op">=</span> Smax<span class="op">*</span>i<span class="op">/</span>np</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> gp <span class="op">=</span> <span class="fu">g</span>(p)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    points[idx<span class="op">++</span>] <span class="op">=</span> { <span class="dt">x</span><span class="op">:</span> <span class="op">-</span>Smax<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="op">-</span>Smax<span class="op">*</span>p <span class="op">-</span> gp<span class="op">,</span> <span class="dt">index</span><span class="op">:</span> i }</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    points[idx<span class="op">++</span>] <span class="op">=</span> { <span class="dt">x</span><span class="op">:</span>  Smax<span class="op">,</span> <span class="dt">y</span><span class="op">:</span>  Smax<span class="op">*</span>p <span class="op">-</span> gp<span class="op">,</span> <span class="dt">index</span><span class="op">:</span> i }</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> points</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="58" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 57;"><span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>averagePlot <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">5</span>] }<span class="op">,</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Axes</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Data</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(legendre<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span> <span class="dt">z</span><span class="op">:</span><span class="st">"index"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span><span class="st">"gray"</span>} )<span class="op">,</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(points<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"point"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"value"</span><span class="op">,</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>                      <span class="dt">stroke</span><span class="op">:</span><span class="st">"red"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span>})<span class="op">,</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div id="fig-affine-sup" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
<figcaption class="figure-caption">Figure&nbsp;41.1: Convex function as a supremum of affine functions</figcaption>
</figure>
</div></div></div>
<p>An illustration of this fact is shown in <a href="#fig-affine-sup">Figure&nbsp;<span>41.1</span></a>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why countable index set?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>From the figure you can convince yourself of the result for an uncountable index set <span class="math inline">\(\bar I\)</span>. Now consider the set <span class="math inline">\(\bar S = \{a_i, b_i\}_{i \in \bar I} \subset \reals^{n+1}\)</span> (for uncountable <span class="math inline">\(\bar I\)</span>). Since <span class="math inline">\(\reals^{n+1}\)</span> is separable, let <span class="math inline">\(S = \{a_i, b_i\}_{i \in I}\)</span> be a countable dense subset of <span class="math inline">\(\bar S\)</span> (where <span class="math inline">\(I\)</span> is countable). Since the supremum over any set is the same as the supremum of its dense subset, we can replace <span class="math inline">\(\bar I\)</span> by <span class="math inline">\(I\)</span>.</p>
</div>
</div>
</div>
<p>The Lengendre-Fenchel transform is a compact way of representing this basic fact. To fix ideas, consider a twice differentiable and strictly convex function <span class="math inline">\(f \colon \reals \to \reals\)</span>. Arbitrarily fix a point <span class="math inline">\(x^∘\)</span> and consider the tangent <span class="math inline">\(τ(x)\)</span> to the plot of <span class="math inline">\(f(⋅)\)</span> at <span class="math inline">\(x^∘\)</span>. This tangent has a slope <span class="math inline">\(p = f'(x^∘)\)</span>. Let <span class="math inline">\(g\)</span> denote the <em>negative</em> <span class="math inline">\(y\)</span>-intercept of the tangent (using the negative <span class="math inline">\(y\)</span>-intercept is just a matter of convention). Thus, the equation for the tangent is: <span class="math display">\[
  τ(x) = p x - g, \quad \forall x \in \reals
\]</span> at at the point <span class="math inline">\(x\)</span>, the tangent <span class="math inline">\(τ\)</span> intercepts the function <span class="math inline">\(f\)</span>; thus, <span class="math inline">\(τ(x^∘) = f(x^∘)\)</span>, or equivalently: <span class="math display">\[
  f(x^∘) = p x^∘ - g
  \quad\hbox{or, equivalently}\quad
  g = p x^∘ - f(x^∘)
\]</span></p>
<p>Note that the <span class="math inline">\(g\)</span> above depends on <span class="math inline">\(x^∘\)</span>. Since <span class="math inline">\(f\)</span> is strictly convex, <span class="math inline">\(f'\)</span> is strictly increasing. Thus, there is a one-to-one relationship between the point <span class="math inline">\(x^∘\)</span> and its slope <span class="math inline">\(p = f'(x^∘)\)</span>. The Lengendre-Fenchel transform is a method to define the intercept <span class="math inline">\(g\)</span> as a function of <span class="math inline">\(p\)</span>. In particular, it is defined as <span class="math display">\[
  g(p) = \sup_{x \in \reals} \{ px - f(x) \}.
\]</span></p>
<p>To understand this definition, suppose <span class="math inline">\(x^∘\)</span> achieves the supremum in the above equation. Then, (i) <span class="math inline">\(f(x^∘) = p x^∘ - g(p)\)</span>; that is the line <span class="math inline">\(px - g(p)\)</span> touches the function <span class="math inline">\(f\)</span> at <span class="math inline">\(x^∘\)</span>; and (ii)&nbsp;at all other points <span class="math inline">\(x \neq x^∘\)</span>, <span class="math inline">\(g(p) &gt; p x - f(x)\)</span> or <span class="math inline">\(f(x) &gt; px - g(p)\)</span>; that is the line <span class="math inline">\(px - g(p)\)</span> lies below the function <span class="math inline">\(f\)</span>. Hence, <span class="math inline">\(px - g(p)\)</span> is a <a href="https://en.wikipedia.org/wiki/Supporting_line">:supporting line</a> of <span class="math inline">\(f\)</span> (and since <span class="math inline">\(f\)</span> is differentiable, equal to its tangent).</p>
<p>An implication of this definition is that for differentiable and convex <span class="math inline">\(f\)</span>, the Legendre transform <span class="math inline">\(g\)</span> of <span class="math inline">\(f\)</span> solves <span class="math display">\[
  g(p) = p x^∘ - f(x^∘)
\]</span> where <span class="math inline">\(x^∘\)</span> solves <span class="math inline">\(p = f'(x^∘)\)</span>, which is called the duality condition.</p>
<div id="exm-legendre-fenchel-quadratic" class="theorem example">
<p><span class="theorem-title"><strong>Example 41.1 </strong></span>Let <span class="math inline">\(f(x) = x^2\)</span>. For a fixed <span class="math inline">\(p\)</span>, the duality condition is <span class="math inline">\(p = 2x^∘\)</span> or <span class="math inline">\(x^∘ = p/2\)</span>. Therefore, <span class="math display">\[
  g(p) = p x^∘ - f(x^∘) = \frac{p^2}{2} - \frac{p^2}{4} = \frac{p^2}{4}.
\]</span></p>
</div>
<div id="exm-legendre-fenchel-polynomial" class="theorem example">
<p><span class="theorem-title"><strong>Example 41.2 </strong></span>Let <span class="math inline">\(f(x) = (x^α)/α\)</span>, where <span class="math inline">\(α &gt; 1\)</span>. For a fixed <span class="math inline">\(p\)</span>, the duality condition is <span class="math inline">\(p = (x^∘)^{α-1}\)</span> or <span class="math inline">\(x^∘ = p^{1/(p-1)}\)</span>. Therefore, <span class="math display">\[
  g(p) = p x^∘ - f(x^∘) = p^{α/(α-1)} - \frac{1}{α} p^{α/(α-1)}
  = \frac{α-1}{α} p^{α/(α-1)}.
\]</span> We can compactly write the above expression is <span class="math inline">\(g(p) = p^β/β\)</span>, where <span class="math inline">\(1/β = 1 - 1/α\)</span>.</p>
</div>
<div id="exm-legendre-fenchel-entropy" class="theorem example">
<p><span class="theorem-title"><strong>Example 41.3 </strong></span>Let <span class="math inline">\(f(x) = x \log x + (1-x) \log (1-x)\)</span>, where the domain is <span class="math inline">\([0,1]\)</span>. This is the negative binary entropy. For a fixed <span class="math inline">\(p\)</span>, the duality condition is <span class="math display">\[
p = f'(x^∘) = \log(x^∘) + 1 - \log(1-x^∘) - 1
% = \log(x^∘) - \log(1-x^∘)
= \log \frac{x^∘}{1-x^∘}
\]</span> Thus, <span class="math inline">\(x^∘ = e^p/(1 + e^p)\)</span>. Therefore, <span class="math display">\[
  g(p) = p x^∘ - f(x^∘) = \log(1 + e^p),
\]</span> where the last step follows after some algebra.</p>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Fenchel-Young inequality
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(g\)</span> be the Legendre-Fenchel transform of <span class="math inline">\(f\)</span>. Then, by definition (changing the variable names for convenience), we have <span class="math display">\[\begin{equation}\tag{Fenchel's inequality}
xy \le f(x) + g(y).
\end{equation}\]</span> For the special case of <a href="#exm-legendre-fenchel-polynomial">Example&nbsp;<span>41.2</span></a>, we have <span class="math display">\[\begin{equation}
\tag{Young's inequality}
xy \le \frac{x^p}{p} + \frac{y^q}{q}
\end{equation}\]</span> where <span class="math inline">\(p, q &gt; 1\)</span> are such that <span class="math inline">\(\frac 1p + \frac 1q = 1\)</span>.</p>
</div>
</div>
<p>An interesting example of Fenchel-Young inequality is the following. Consider a real-valued, strictly increasing, continuous function <span class="math inline">\(h\)</span> on <span class="math inline">\(\reals\)</span> which satisfies <span class="math inline">\(h(0) = 0\)</span>, <span class="math inline">\(h(x) \to -∞\)</span> as <span class="math inline">\(x \to -∞\)</span>, and <span class="math inline">\(h(x) \to ∞\)</span> as <span class="math inline">\(x \to ∞\)</span>. Since <span class="math inline">\(h\)</span> is continuous and strictly increasing, it has an inverse. Define <span class="math display">\[\begin{equation}\label{eq:legendre-example}
  f(x) = \int_{0}^x h(s) ds
  \quad\hbox{and}\quad
  g(y) = \int_{0}^y h^{-1}(t) dt.
\end{equation}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="163" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 162;"><span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>exampleFunction <span class="op">=</span> <span class="kw">function</span>(s) {</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="op">&lt;=</span> <span class="dv">1</span>) {</span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (s <span class="op">-</span> s<span class="op">**</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span> <span class="op">+</span> (s <span class="op">-</span> <span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>examplePoints <span class="op">=</span> {</span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> points <span class="op">=</span> <span class="kw">new</span> <span class="bu">Array</span>()</span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> idx <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> n <span class="op">=</span> <span class="dv">500</span><span class="op">;</span></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> Smax <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> </span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> s <span class="op">=</span> Smax<span class="op">*</span>i<span class="op">/</span>n</span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>      points[idx<span class="op">++</span>] <span class="op">=</span> { <span class="dt">x</span><span class="op">:</span> s<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fu">exampleFunction</span>(s) } </span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> points</span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div>
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="195" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 194;"><span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span> <span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"s"</span>}<span class="op">,</span> </span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span> <span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"t"</span>}<span class="op">,</span> </span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Fill</span></span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">areaY</span>(examplePoints<span class="op">.</span><span class="fu">filter</span>(pt <span class="kw">=&gt;</span> pt<span class="op">.</span><span class="at">x</span> <span class="op">&lt;=</span> <span class="dv">1</span>)<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span></span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a>               <span class="dt">fill</span><span class="op">:</span><span class="st">"lightblue"</span><span class="op">,</span> <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.5</span>})<span class="op">,</span></span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">areaX</span>(examplePoints<span class="op">.</span><span class="fu">filter</span>(pt <span class="kw">=&gt;</span> pt<span class="op">.</span><span class="at">y</span> <span class="op">&lt;=</span> <span class="fl">0.7</span>)<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span></span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a>               <span class="dt">fill</span><span class="op">:</span><span class="st">"pink"</span><span class="op">,</span> <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.5</span>})<span class="op">,</span></span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Axes</span></span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>([ {<span class="dt">x</span><span class="op">:</span><span class="dv">1</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="dv">0</span>}<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="dv">1</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fu">exampleFunction</span>(<span class="dv">1</span>)} ]<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"gray"</span>} )<span class="op">,</span></span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>([ {<span class="dt">x</span><span class="op">:</span><span class="dv">1</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fu">exampleFunction</span>(<span class="dv">1</span>)}<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="dv">1</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fl">0.7</span>} ]<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span> <span class="dt">strokeDasharray</span><span class="op">:</span> <span class="st">"4"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"gray"</span>} )<span class="op">,</span></span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>([ {<span class="dt">x</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="fl">0.7</span>}<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="fl">1.62</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="fl">0.7</span>} ]<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"gray"</span>} )<span class="op">,</span></span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Line</span></span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(examplePoints<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span></span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a>              <span class="dt">stroke</span><span class="op">:</span><span class="st">"red"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span>})<span class="op">,</span></span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span> <span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"s"</span>}<span class="op">,</span> </span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span> <span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"t"</span>}<span class="op">,</span> </span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Fill</span></span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">areaY</span>(examplePoints<span class="op">.</span><span class="fu">filter</span>(pt <span class="kw">=&gt;</span> pt<span class="op">.</span><span class="at">x</span> <span class="op">&lt;=</span> <span class="fl">1.4</span>)<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span></span>
<span id="cb4-232"><a href="#cb4-232" aria-hidden="true" tabindex="-1"></a>               <span class="dt">fill</span><span class="op">:</span><span class="st">"lightblue"</span><span class="op">,</span> <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.5</span>})<span class="op">,</span></span>
<span id="cb4-233"><a href="#cb4-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-234"><a href="#cb4-234" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">areaX</span>(examplePoints<span class="op">.</span><span class="fu">filter</span>(pt <span class="kw">=&gt;</span> pt<span class="op">.</span><span class="at">y</span> <span class="op">&lt;=</span> <span class="fl">0.4</span>)<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span></span>
<span id="cb4-235"><a href="#cb4-235" aria-hidden="true" tabindex="-1"></a>               <span class="dt">fill</span><span class="op">:</span><span class="st">"pink"</span><span class="op">,</span> <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.5</span>})<span class="op">,</span></span>
<span id="cb4-236"><a href="#cb4-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-237"><a href="#cb4-237" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Axes</span></span>
<span id="cb4-238"><a href="#cb4-238" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb4-239"><a href="#cb4-239" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb4-240"><a href="#cb4-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-241"><a href="#cb4-241" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>([ {<span class="dt">x</span><span class="op">:</span><span class="fl">1.4</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="dv">0</span>}<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="fl">1.4</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fu">exampleFunction</span>(<span class="fl">1.4</span>)} ]<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"gray"</span>} )<span class="op">,</span></span>
<span id="cb4-242"><a href="#cb4-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-243"><a href="#cb4-243" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>([ {<span class="dt">x</span><span class="op">:</span><span class="fl">0.55</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fl">0.4</span>}<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="fl">1.4</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fl">0.4</span>} ]<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span> <span class="dt">strokeDasharray</span><span class="op">:</span> <span class="st">"4"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"gray"</span>} )<span class="op">,</span></span>
<span id="cb4-244"><a href="#cb4-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-245"><a href="#cb4-245" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>([ {<span class="dt">x</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="fl">0.4</span>}<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="fl">0.55</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="fl">0.4</span>} ]<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"gray"</span>} )<span class="op">,</span></span>
<span id="cb4-246"><a href="#cb4-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-247"><a href="#cb4-247" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Line</span></span>
<span id="cb4-248"><a href="#cb4-248" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">line</span>(examplePoints<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span></span>
<span id="cb4-249"><a href="#cb4-249" aria-hidden="true" tabindex="-1"></a>              <span class="dt">stroke</span><span class="op">:</span><span class="st">"red"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span>})<span class="op">,</span></span>
<span id="cb4-250"><a href="#cb4-250" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-251"><a href="#cb4-251" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb4-252"><a href="#cb4-252" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-legendre-example" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="fig-legendre-example-1" class="quarto-figure quarto-figure-center anchored" style="flex-basis: 50.0%;justify-content: center;">
<figure class="figure">
<div id="ojs-cell-4-1" data-nodetype="expression">

</div>
<figcaption class="figure-caption">(a) <span class="math inline">\(x &lt; y\)</span>, with <span class="math inline">\(x = 1\)</span> and <span class="math inline">\(y = 0.7\)</span></figcaption>
</figure>
</div>
<div id="fig-legendre-example-2" class="quarto-figure quarto-figure-center anchored" style="flex-basis: 50.0%;justify-content: center;">
<figure class="figure">
<div id="ojs-cell-4-2" data-nodetype="expression">

</div>
<figcaption class="figure-caption">(b) <span class="math inline">\(x &gt; y\)</span>, with <span class="math inline">\(x = 1.4\)</span> and <span class="math inline">\(y = 0.4\)</span></figcaption>
</figure>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;41.2: The functions <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(y)\)</span> defined in \eqref{eq:legendre-example}. The red curve shows the graph of <span class="math inline">\(t = h(s)\)</span>. The shaded blue region shows the value of <span class="math inline">\(f(x)\)</span> for a particular value of <span class="math inline">\(x\)</span>. The red curve shown the value of <span class="math inline">\(g(y)\)</span> for a particular value of <span class="math inline">\(y\)</span>.</figcaption><p></p>
</figure>
</div>
</div>
<p>The graph of <span class="math inline">\(t = h(s)\)</span> is shown in <a href="#fig-legendre-example">Figure&nbsp;<span>41.2</span></a>, where the shaded portions represent <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(y)\)</span>. From the plots, we can infer Fenchel-Young’s inequality: <span class="math display">\[
  xy \le f(x) + g(y)
\]</span> with equality if and only if <span class="math inline">\(y = h(x) = \dot f(x)\)</span>. This immediately implies that <span class="math display">\[
  g(y) = \sup_{x \in \reals} \bigl\{ xy - f(x) \bigr\}
\]</span> and <span class="math display">\[
  f(x) = \sup_{y \in \reals} \bigl\{ xy - g(y) \bigr\}.
\]</span></p>
</section>
<section id="general-definition" class="level2" data-number="41.2">
<h2 data-number="41.2" class="anchored" data-anchor-id="general-definition"><span class="header-section-number">41.2</span> General definition</h2>
<div id="def-Legendre-Fenchel-transform" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 41.1 </strong></span>For any function <span class="math inline">\(f \colon \reals^n \to \bar {\reals}\)</span>, the function <span class="math inline">\(f^* \colon \reals^n \to \bar \reals\)</span> defined by <span class="math display">\[\begin{equation}\label{eq:conjugate}
  f^*(p) \coloneqq \sup_{x \in \reals^n} \bigl\{
  \langle p, x \rangle - f(x) \bigr\}
\end{equation}\]</span> is <strong>conjugate</strong> to <span class="math inline">\(f\)</span>, while the function <span class="math inline">\(f^{**} = (f^*)^*\)</span> defined by <span class="math display">\[\begin{equation}\label{eq:biconjugate}
  f^{**}(x) \coloneqq \sup_{p \in \reals^n} \bigl\{
  \langle p, x \rangle - f^*(p) \bigr\}
\end{equation}\]</span> is <strong>biconjugate</strong> to <span class="math inline">\(f\)</span>. The mapping <span class="math inline">\(f \mapsto f^*\)</span> is called <strong>Legendre-Fenchel transform</strong>.</p>
</div>
<p>The significance of the conjugate can be understood in terms of epigraph relationships. Note that \eqref{eq:conjugate} implies that <span class="math display">\[
  (p,β) \in \text{epi } f^*
  \iff
  β \ge \langle p, x \rangle - α
  \text{ for all } (x,α) \in \text{epi } f.
\]</span> Let <span class="math inline">\(\ell_{p,β}(x) \coloneqq \langle p, x \rangle - β\)</span>, then we can write the above relationship as <span class="math display">\[
  (p,β) \in \text{epi } f^*
  \iff
  \ell_{p,β} \le f,
\]</span> that is, <span class="math inline">\(f^*\)</span> describes a family of affine functions majorized by <span class="math inline">\(f\)</span>. Similarly, <span class="math display">\[
  β \ge f^*(p)
  \iff
  β \ge \ell_{x,α}(p)
  \text{ for all } (x,α) \in \text{epi } f.
\]</span></p>
<div id="thm-legendre-fenchel" class="theorem">
<p><span class="theorem-title"><strong>Theorem 41.1 </strong></span>For any function <span class="math inline">\(f \colon \reals^n \to \bar \reals\)</span> with <span class="math inline">\(\text{con } f\)</span> proper, both <span class="math inline">\(f^*\)</span> and <span class="math inline">\(f^{**}\)</span> are proper, lsc, convex and <span class="math display">\[
  f^{**} = \text{cl con } f.
\]</span> Thus, <span class="math inline">\(f^{**} \le f\)</span> and when <span class="math inline">\(f\)</span> is itself proper, lsc, and convex, one has <span class="math inline">\(f^{**} = f\)</span>.</p>
</div>
</section>
<section id="properties-of-legendre-fenchel-transform" class="level2" data-number="41.3">
<h2 data-number="41.3" class="anchored" data-anchor-id="properties-of-legendre-fenchel-transform"><span class="header-section-number">41.3</span> Properties of Legendre-Fenchel transform</h2>
<p>Thus, Legendre-Fenchel transform sets up a one-to-one correspondence in the class of proper, lsc, and convex functions: if <span class="math inline">\(f\)</span> is conjugate to <span class="math inline">\(g\)</span>, then <span class="math inline">\(g\)</span> is a conjugate to <span class="math inline">\(f\)</span>: <span class="math display">\[
f \xleftrightarrow{\hskip0.5em*\hskip0.5em} g
\text { when }
\begin{cases}
g(p) = \sup_{x \in \reals^n} \bigl\{ \langle p, x \rangle - f(x) \bigr\} \\
f(x) = \sup_{x \in \reals^n} \bigl\{ \langle p, x \rangle - g(p) \bigr\}
\end{cases}
\]</span></p>
<p>Given <span class="math inline">\(f \xleftrightarrow{\hskip0.5em*\hskip0.5em} g\)</span>, we have the following properties:</p>
<ol type="1">
<li><p><strong>Scaling properties.</strong> For any <span class="math inline">\(λ &gt; 0\)</span>, <span class="math display">\[\begin{align*}
λ f(x)
&amp;\xleftrightarrow{\hskip0.5em*\hskip0.5em}
λg(λ^{-1} p),
\\
f(λx)
&amp;\xleftrightarrow{\hskip0.5em*\hskip0.5em}
g(λ^{-1} p),
\end{align*}\]</span></p></li>
<li><p><strong>Translation properties.</strong> <span class="math display">\[\begin{align*}
f(x) - \langle a, x \rangle
&amp;\xleftrightarrow{\hskip0.5em*\hskip0.5em}
g(p + a) ,
\\
f(x + b)
&amp;\xleftrightarrow{\hskip0.5em*\hskip0.5em}
g(p) - \langle p, b \rangle,
\\
f(x) + c
&amp;\xleftrightarrow{\hskip0.5em*\hskip0.5em}
g(p) - c,
\\
\end{align*}\]</span></p></li>
</ol>
<div id="prp-legendre-strong-convex" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 41.1 </strong></span>Let <span class="math inline">\(f\)</span> be a finite, coercive, twice differentiable, and strongly convex function, then the conjugate <span class="math inline">\(g = f^*\)</span> is also finite, coercive, twice differentiable, and strongly convex. Moreover,</p>
<ul>
<li><p>the gradient mapping <span class="math inline">\(\GRAD f\)</span> is one-to-one from <span class="math inline">\(\reals^n\)</span> to <span class="math inline">\(\reals^n\)</span>, and its inverse is <span class="math inline">\(\GRAD g\)</span>; one has <span class="math display">\[\begin{align*}
g(p) &amp;= \bigl\langle (\GRAD f)^{-1}(p), p \bigr\rangle
- f\bigl((\GRAD f)^{-1}(p)\bigr), \\
f(x) &amp;= \bigl\langle (\GRAD g)^{-1}(x), x \bigr\rangle
- g\bigl((\GRAD g)^{-1}(x)\bigr),
\end{align*}\]</span></p></li>
<li><p>The matrices <span class="math inline">\(\GRAD^2 f(x)\)</span> and <span class="math inline">\(\GRAD^2 g(p)\)</span> are inverse to one another when <span class="math inline">\(p = \GRAD f(x)\)</span> or, equivalently, <span class="math inline">\(x = \GRAD g(p)\)</span>.</p></li>
</ul>
</div>
<p>Strongly convex functions on a simplex have the following properties.</p>
<div id="prp-legendre-simplex" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 41.2 </strong></span>Let <span class="math inline">\(Δ\)</span> be the simplex in <span class="math inline">\(\reals^n\)</span> and <span class="math inline">\(f \colon Δ \to \reals\)</span> be twice differentiable and strongly convex. Let <span class="math inline">\(g \colon \reals^n \to \reals\)</span> be the Legendre-Fenchel conjugate of <span class="math inline">\(f\)</span>. Then,</p>
<ol type="1">
<li><p><strong>Unique maximizing argument:</strong> <span class="math inline">\(\GRAD g\)</span> is Lipschitz and satisfies <span class="math display">\[\GRAD g(p) = \arg\max_{x \in Δ}\bigl\{ \langle x, p \rangle - f(x) \bigr\}.\]</span></p></li>
<li><p><strong>Boundedness:</strong> If there are constants <span class="math inline">\(L\)</span> and <span class="math inline">\(U\)</span> such that for all <span class="math inline">\(x \in Δ\)</span>, we have <span class="math inline">\(L \le f(x) \le U\)</span>, then <span class="math display">\[
   \| p \|_{∞} - U \le g(p) \le \| p \|_{∞} - L.
\]</span></p></li>
<li><p><strong>Distributivity:</strong> For any <span class="math inline">\(c \in \reals\)</span>, <span class="math display">\[
   g(p + c \ONES) = g(p) + c.
\]</span></p></li>
<li><p><strong>Monotonicity:</strong> If <span class="math inline">\(p_1 \le p_2\)</span>, then <span class="math inline">\(g(p_1) \le g(p_2)\)</span>.</p></li>
</ol>
</div>
</section>
<section id="notes" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="notes">Notes</h2>
<p>The material on the intuition behind Legendre-Fenchel transform is adapted from <span class="citation" data-cites="Kennerly2011">Kennerly (<a href="../references.html#ref-Kennerly2011" role="doc-biblioref">2011</a>)</span>. The example for Young-Fenchel inequality and <a href="#fig-legendre-example">Figure&nbsp;<span>41.2</span></a> is taken from <span class="citation" data-cites="Ellis1985">Ellis (<a href="../references.html#ref-Ellis1985" role="doc-biblioref">1985</a>)</span>. The material on general definition and properties is adapted from <span class="citation" data-cites="Rockafellar2009">Rockafellar and Wets (<a href="../references.html#ref-Rockafellar2009" role="doc-biblioref">2009</a>)</span>. <a href="#prp-legendre-strong-convex">Proposition&nbsp;<span>41.1</span></a> is stated as Example&nbsp;11.9 in <span class="citation" data-cites="Rockafellar2009">Rockafellar and Wets (<a href="../references.html#ref-Rockafellar2009" role="doc-biblioref">2009</a>)</span>. <a href="#prp-legendre-simplex">Proposition&nbsp;<span>41.2</span></a> is from <span class="citation" data-cites="Geist2019">Geist et al. (<a href="../references.html#ref-Geist2019" role="doc-biblioref">2019</a>)</span>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Ellis1985" class="csl-entry" role="listitem">
<span class="smallcaps">Ellis, R.S.</span> 1985. <em>Entropy, large deviations, and statistical mechanics</em>. Springer New York. DOI: <a href="https://doi.org/10.1007/978-1-4613-8533-2">10.1007/978-1-4613-8533-2</a>.
</div>
<div id="ref-Geist2019" class="csl-entry" role="listitem">
<span class="smallcaps">Geist, M., Scherrer, B., and Pietquin, O.</span> 2019. A theory of regularized <span>M</span>arkov decision processes. <em>Proceedings of the 36th international conference on machine learning</em>, PMLR, 2160–2169. Available at: <a href="https://proceedings.mlr.press/v97/geist19a.html">https://proceedings.mlr.press/v97/geist19a.html</a>.
</div>
<div id="ref-Kennerly2011" class="csl-entry" role="listitem">
<span class="smallcaps">Kennerly, S.</span> 2011. A graphical derivation of the legendre transform. Available at: <a href="http://einstein.drexel.edu/~skennerly/maths/Legendre.pdf">http://einstein.drexel.edu/~skennerly/maths/Legendre.pdf</a>.
</div>
<div id="ref-Rockafellar2009" class="csl-entry" role="listitem">
<span class="smallcaps">Rockafellar, R.T. and Wets, R.J.-B.</span> 2009. <em>Variational analysis</em>. Springer Science &amp; Business Media.
</div>
</div>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"Smax = 2\nn = 100\nnp = 3\n\nf = function(s) { return s*s + 1 }\n// Legendre transform of f\ng = function(s) { return s*s/4 - 1 }\n\npoints = {\n\n  var points = new Array()\n  var idx = 0\n  for( var i = -n ; i <= n; i++) {\n    var s = Smax*i/n\n    points[idx++] = { point: s, value: f(s) }\n  }\n  return points\n  }\n\nlegendre = {\n  var points = new Array()\n  var idx = 0\n\n  for( var i = -np; i <= np; i++) {\n    var p = Smax*i/np\n    var gp = g(p)\n    points[idx++] = { x: -Smax, y: -Smax*p - gp, index: i }\n    points[idx++] = { x:  Smax, y:  Smax*p - gp, index: i }\n  }\n\n  return points\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"averagePlot = Plot.plot({\n  grid: true,\n  y: { domain: [0, 5] },\n\n  marks: [\n    // Axes\n    Plot.ruleX([0]),\n    Plot.ruleY([0]),\n    // Data\n    Plot.line(legendre, {x:\"x\", y:\"y\", z:\"index\", stroke:\"gray\"} ),\n\n    Plot.line(points, {x:\"point\", y:\"value\",\n                      stroke:\"red\", strokeWidth: 4}),\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-3","inline":false,"source":"\nexampleFunction = function(s) {\n    if (s <= 1) {\n        return (s - s**2/2)\n    } else\n    {\n        return 1/2 + (s - 1)**2/2\n    }\n  }\n\nexamplePoints = {\n  var points = new Array()\n  var idx = 0\n\n  const n = 500;\n  const Smax = 2; \n\n  for(var i = 0; i <= n; i++) {\n      var s = Smax*i/n\n      points[idx++] = { x: s, y: exampleFunction(s) } \n  }\n  return points\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-4","inline":false,"source":"\nPlot.plot({\n  grid: true,\n  x : { label: \"s\"}, \n  y : { label: \"t\"}, \n\n  marks: [\n    // Fill\n    Plot.areaY(examplePoints.filter(pt => pt.x <= 1), {x:\"x\", y:\"y\",\n               fill:\"lightblue\", fillOpacity: 0.5}),\n\n    Plot.areaX(examplePoints.filter(pt => pt.y <= 0.7), {x:\"x\", y:\"y\",\n               fill:\"pink\", fillOpacity: 0.5}),\n\n    // Axes\n    Plot.ruleX([0]),\n    Plot.ruleY([0]),\n\n    Plot.line([ {x:1, y:0}, {x:1, y: exampleFunction(1)} ], {x:\"x\", y:\"y\", stroke: \"gray\"} ),\n\n    Plot.line([ {x:1, y: exampleFunction(1)}, {x:1, y: 0.7} ], {x:\"x\", y:\"y\", strokeDasharray: \"4\", stroke: \"gray\"} ),\n\n    Plot.line([ {x:0, y:0.7}, {x:1.62, y:0.7} ], {x:\"x\", y:\"y\", stroke: \"gray\"} ),\n\n    // Line\n    Plot.line(examplePoints, {x:\"x\", y:\"y\",\n              stroke:\"red\", strokeWidth: 4}),\n    \n  ]\n})\n\nPlot.plot({\n  grid: true,\n  x : { label: \"s\"}, \n  y : { label: \"t\"}, \n\n  marks: [\n    // Fill\n    Plot.areaY(examplePoints.filter(pt => pt.x <= 1.4), {x:\"x\", y:\"y\",\n               fill:\"lightblue\", fillOpacity: 0.5}),\n\n    Plot.areaX(examplePoints.filter(pt => pt.y <= 0.4), {x:\"x\", y:\"y\",\n               fill:\"pink\", fillOpacity: 0.5}),\n\n    // Axes\n    Plot.ruleX([0]),\n    Plot.ruleY([0]),\n\n    Plot.line([ {x:1.4, y:0}, {x:1.4, y: exampleFunction(1.4)} ], {x:\"x\", y:\"y\", stroke: \"gray\"} ),\n\n    Plot.line([ {x:0.55, y: 0.4}, {x:1.4, y: 0.4} ], {x:\"x\", y:\"y\", strokeDasharray: \"4\", stroke: \"gray\"} ),\n\n    Plot.line([ {x:0, y:0.4}, {x:0.55, y:0.4} ], {x:\"x\", y:\"y\", stroke: \"gray\"} ),\n\n    // Line\n    Plot.line(examplePoints, {x:\"x\", y:\"y\",\n              stroke:\"red\", strokeWidth: 4}),\n    \n  ]\n})\n\n\n"}]}
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../convexity";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../convexity/convexity.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Convex sets and convex functions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>