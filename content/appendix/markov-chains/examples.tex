\usebodyfont[termes,10pt]

\startMPdefinitions
  u := 2cm;

  path state;

  state := fullcircle scaled (2EmWidth);

  path leftloop, rightloop;

  leftloop := (0,0) {dir 150} .. (-0.5u,0) .. {dir 30} (0,0);
  rightloop := (0,0) {dir 30} .. (0.5u,0) .. {dir 150} (0,0);


\stopMPdefinitions

\starttext
\startMPpage[offset=1mm,scale=1250]
  pickup pencircle scaled 1bp;
  path p[], q[];

  q[0] := state;
  q[1] := state shifted (u,0);

  p[1] := origin {dir 60} .. (u,0);

  drawarrow leftloop cutbefore q[0] cutafter q[0] ;
  label.lft("\switchtobodyfont[8pt]$q$", point 0.5 along leftloop);

  drawarrow rightloop shifted (u,0) cutbefore q[1] cutafter q[1] ;
  label.rt("\switchtobodyfont[8pt]$1$", point 0.5 along rightloop shifted (u,0));

  drawarrow p[1] cutbefore q[0] cutafter q[1];
  label.top("\switchtobodyfont[8pt]$p$", point 0.5 along p[1]);
  
  draw q[0];
  draw q[1];

  label("$0$", origin);
  label("$1$", (u,0) );

\stopMPpage

\startMPpage[offset=1mm, scale=1250]
  pickup pencircle scaled 1bp;
  q[0] := state;
  q[1] := state shifted (u,0);
  q[2] := state shifted (2u,0);

  p[1] := origin {dir 60} .. (u,0);
  p[2] := (u,0) {dir 60} .. (2u,0);
  p[3] := (u,0) {dir 240} .. (0,0);

  drawarrow leftloop cutbefore q[0] cutafter q[0] ;
  label.lft("\switchtobodyfont[8pt]$q$", point 0.5 along leftloop);

  drawarrow rightloop shifted (2u,0) cutbefore q[2] cutafter q[2] ;
  label.rt("\switchtobodyfont[8pt]$1$", point 0.5 along rightloop shifted (2u,0));

  drawarrow p[1] cutbefore q[0] cutafter q[1];
  label.top("\switchtobodyfont[8pt]$p$", point 0.5 along p[1]);

  drawarrow p[2] cutbefore q[1] cutafter q[2];
  label.top("\switchtobodyfont[8pt]$p$", point 0.5 along p[2]);

  drawarrow p[3] cutbefore q[1] cutafter q[0];
  label.bot("\switchtobodyfont[8pt]$q$", point 0.5 along p[3]);
  
  draw q[0];
  draw q[1];
  draw q[2];

  label("$0$", origin);
  label("$1$", (u,0) );
  label("$2$", (2u,0) );

\stopMPpage

\startMPpage[offset=1mm, scale=1250]
  pickup pencircle scaled 1bp;
  q[0] := state;
  q[1] := state shifted (u,0);
  q[2] := state shifted (2u,0);
  q[3] := state shifted (3u,0);

  p[0] := origin {dir 60} .. (u,0);
  p[1] := (u,0) {dir 60} .. (2u,0);
  p[2] := (2u,0) {dir 60} .. (3u,0);

  p[11] := (u,0) {dir 240} .. (0,0);
  p[12] := (2u,0) {dir 240} .. (u,0);

  drawarrow leftloop cutbefore q[0] cutafter q[0] ;
  label.lft("\switchtobodyfont[8pt]$q$", point 0.5 along leftloop);

  drawarrow rightloop shifted (3u,0) cutbefore q[3] cutafter q[3] ;
  label.rt("\switchtobodyfont[8pt]$1$", point 0.5 along rightloop shifted (3u,0));

  drawarrow p[0] cutbefore q[0] cutafter q[1];
  label.top("\switchtobodyfont[8pt]$p$", point 0.5 along p[0]);

  drawarrow p[1] cutbefore q[1] cutafter q[2];
  label.top("\switchtobodyfont[8pt]$p$", point 0.5 along p[1]);

  drawarrow p[2] cutbefore q[2] cutafter q[3];
  label.top("\switchtobodyfont[8pt]$p$", point 0.5 along p[2]);

  drawarrow p[11] cutbefore q[1] cutafter q[0];
  label.bot("\switchtobodyfont[8pt]$q$", point 0.5 along p[11]);

  drawarrow p[12] cutbefore q[2] cutafter q[1];
  label.bot("\switchtobodyfont[8pt]$q$", point 0.5 along p[12]);
  
  draw q[0];
  draw q[1];
  draw q[2];
  draw q[3];

  label("$0$", origin);
  label("$1$", (u,0) );
  label("$2$", (2u,0) );
  label("$3$", (3u,0) );

\stopMPpage
\stoptext
