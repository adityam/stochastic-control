<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aditya Mahajan">
<meta name="dcterms.date" content="2024-02-02">
<meta name="keywords" content="stochastic optimization, principle of irrelevant information">
<meta name="description" content="ECES 506 (Stochastic Control and Decision Theory)">

<title>Course Notes - 1&nbsp; Introduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../stochastic-optimization/newsvendor.html" rel="next">
<link href="../index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../site_libs/quarto-contrib/nutshell-1.0.6/nutshell.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script>
// https://github.com/mathjax/MathJax/issues/2744#issuecomment-1658624747
// To fix the bug that uppercase unicode letters are shown in italic
window.MathJax = {
  startup: {
    ready() {
      const {RANGES} = MathJax._.core.MmlTree.OperatorDictionary;
      const {TEXCLASS} = MathJax._.core.MmlTree.MmlNode;
      RANGES.splice(4, 1,
        [0x0370, 0x0385, TEXCLASS.ORD, 'mi'],
        [0x0386, 0x3AB, TEXCLASS.ORD, 'mi', 'normal'],
        [0x03AC, 0x1A20, TEXCLASS.ORD, 'mi']
      );
      MathJax.startup.defaultReady();
    }
  },
  tex: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: true,
    tags: "ams",
    macros: {
      PR: "\\mathbb{P}",
      EXP: "\\mathbb{E}",
      IND: "\\mathbb{I}",
      ONES: "\\mathbb{1}",
      reals: "\\mathbb{R}",
      integers: "\\mathbb{Z}",
      BLANK: "\\mathfrak{E}",
      TRANS: "\\intercal",
      BELLMAN: "\\mathcal{B}",
      RICCATI: "\\mathcal{R}",
      GAIN: "\\mathcal{G}",
      GREEDY: "\\mathcal{G}",
      MISMATCH: "\\mathcal{D}",
      VEC: "\\operatorname{vec}",
      diag: "\\operatorname{diag}",
      ROWS: "\\operatorname{vec}",
      TR: "\\operatorname{Tr}",   
      SPAN: "\\operatorname{sp}",   
      DRE: "\\operatorname{DRE}",   
      DARE: "\\operatorname{DARE}",   
      LQR: "\\operatorname{LQR}",   
      ALPHABET: ["\\mathcal{#1}", 1],
      MATRIX: ["\\begin{bmatrix} #1 \\end{bmatrix}", 1],
      NORM: ["\\left\\lVert \\mathstrut #1 \\right\\rVert", 1],
      ABS: ["\\left\\lvert \\mathstrut #1 \\right\\rvert", 1],
      GRAD: "\\nabla"
    },
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
};
</script>
<script async="" data-id="101261731" src="//static.getclicky.com/js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../stochastic-control/index.html"> 
<span class="menu-text">Stochastic Control</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/adityam/stochastic-control" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../stochastic-optimization/intro.html">Stochastic Optimization</a></li><li class="breadcrumb-item"><a href="../stochastic-optimization/intro.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the course</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Stochastic Optimization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stochastic-optimization/intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stochastic-optimization/newsvendor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The newsvendor problem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stochastic-optimization/certainty-equivalence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Certainty equivalence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stochastic-optimization/interchange.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interchange arguments</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">MDPs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Finite horizon MDPs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/gambling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Optimal gambling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/inventory-management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Inventory Management</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/monotone-mdps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Monotonicity of value function and optimal policies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/monotone-examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Examples of monotonicity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/reward-shaping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Reward Shaping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/optimal-stopping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Optimal stopping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/inf-horizon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Infinite horizon MDPs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/mdp-algorithms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">MDP algorithms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/inventory-management-revisited.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Inventory management (revisted)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/mobile-edge-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Service Migration in Mobile edge computing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/computational-complexity-vi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Computational complexity of value interation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/martingale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Thirfty and equalizing policies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/linear-programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Linear programming formulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/lipschitz-mdps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Lipschitz MDPs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mdps/periodic-mdps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Periodic MDPs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">POMDPs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pomdps/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pomdps/sequential-hypothesis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Sequential hypothesis testing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Approx DP</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../approx-mdps/approx-DP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Approximate dynamic programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../approx-mdps/policy-loss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Upper bounds on policy loss</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../approx-mdps/model-approximation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Model approximation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Risk sensitive MDPs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../risk-sensitive/risk-sensitive-utility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Risk Sensitive Utility</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../risk-sensitive/risk-sensitive-mdps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Risk Sensitive MDPs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Linear systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-systems/lqr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Linear quadratic regulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-systems/large-scale-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Large scale systems</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">RL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rl/stochastic-approximation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Stochastic approximation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">Dec-POMDPs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dec-pomdps/designers-approach.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Designer’s Approach</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">Probability Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/convergence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Convergence of random variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/sub-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Sub-Gaussian random variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/change-of-measure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Change of Measure</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/IPM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Integral Probablity Metrics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/markov-chains.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Markov chains</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/martingales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Martingales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/stochastic-stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Stochastic stability</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
 <span class="menu-text">Linear Algebra Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-algebra/matrix-relationships.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Some useful matrix relationships</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-algebra/positive-definite-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Positive definite matrices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-algebra/svd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Singular value decomposition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear-algebra/rkhs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Reproducing Kernel Hilbert Space</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
 <span class="menu-text">Convexity Appendix</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../convexity/convexity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Convex sets and convex functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../convexity/duality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Duality</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 2</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-stochastic-optimization-problem" id="toc-the-stochastic-optimization-problem" class="nav-link active" data-scroll-target="#the-stochastic-optimization-problem"><span class="header-section-number">1.1</span> The stochastic optimization problem</a></li>
  <li><a href="#key-simplifying-idea" id="toc-key-simplifying-idea" class="nav-link" data-scroll-target="#key-simplifying-idea"><span class="header-section-number">1.2</span> Key simplifying idea</a></li>
  <li><a href="#an-example-optimal-policy-in-a-card-game" id="toc-an-example-optimal-policy-in-a-card-game" class="nav-link" data-scroll-target="#an-example-optimal-policy-in-a-card-game"><span class="header-section-number">1.3</span> An example: optimal policy in a card game</a></li>
  <li><a href="#a-tree-representation-of-the-optimization-problem" id="toc-a-tree-representation-of-the-optimization-problem" class="nav-link" data-scroll-target="#a-tree-representation-of-the-optimization-problem"><span class="header-section-number">1.4</span> A tree representation of the optimization problem</a>
  <ul class="collapse">
  <li><a href="#one-step-optimization-with-perfect-observation" id="toc-one-step-optimization-with-perfect-observation" class="nav-link" data-scroll-target="#one-step-optimization-with-perfect-observation"><span class="header-section-number">1.4.1</span> One-step optimization with perfect observation</a></li>
  <li><a href="#one-step-optimization-with-imperfect-observation" id="toc-one-step-optimization-with-imperfect-observation" class="nav-link" data-scroll-target="#one-step-optimization-with-imperfect-observation"><span class="header-section-number">1.4.2</span> One-step optimization with imperfect observation</a></li>
  </ul></li>
  <li><a href="#blackwells-principle-of-irrelevant-information" id="toc-blackwells-principle-of-irrelevant-information" class="nav-link" data-scroll-target="#blackwells-principle-of-irrelevant-information"><span class="header-section-number">1.5</span> Blackwell’s principle of irrelevant information</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/adityam/stochastic-control/edit/quarto/stochastic-optimization/intro.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../stochastic-optimization/intro.html">Stochastic Optimization</a></li><li class="breadcrumb-item"><a href="../stochastic-optimization/intro.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="http://www.cim.mcgill.ca/~adityam">Aditya Mahajan</a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="http://www.mcgill.ca/ece">
            McGill University
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Updated</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 2, 2024</p>
    </div>
  </div>
  
    
  </div>
  

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>stochastic optimization, principle of irrelevant information</p>
  </div>
</div>

</header>


<p>Let’s start with the simplest optimization problem. A decision maker has to choose an action <span class="math inline">\(a \in \ALPHABET A\)</span>. Upon choosing the action <span class="math inline">\(a\)</span>, the decision maker incurs a cost <span class="math inline">\(c(a)\)</span>. What action should the decision maker pick to minimize the cost?</p>
<p>Formally, the above optimization problem may be written as <span class="math display">\[\begin{equation} \label{eq:basic}
\min_{a \in \ALPHABET A} c(a).
\end{equation}\]</span></p>
<p>When the <em>action space</em> <span class="math inline">\(\ALPHABET A\)</span> is finite, say <span class="math inline">\(\ALPHABET A = \{1,
\dots, m\}\)</span>, solving the optimization problem <span class="math inline">\(\eqref{eq:basic}\)</span> is conceptually straight-forward: enumerate the cost of all possible actions, i.e., enumerate the set <span class="math inline">\(C = \{ c(a) : a \in \ALPHABET A \}\)</span> and find the smallest element.</p>
<p>When the action space <span class="math inline">\(\ALPHABET A\)</span> is continuous, say a compact subset of a Euclidean space, solving the optimization problem \eqref{eq:basic} is conceptually straight-forward only when the cost function <span class="math inline">\(c\)</span> satisfies some regularity conditions. For example, when <span class="math inline">\(c\)</span> is convex, the optimal action can be obtained for solving <span class="math display">\[ \dfrac {d c(a) }{ da } = 0. \]</span></p>
<p>In the absence of appropriate regularity conditions, it is not possible to solve an optimization problem over continuous action spaces.</p>
<section id="the-stochastic-optimization-problem" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="the-stochastic-optimization-problem"><span class="header-section-number">1.1</span> The stochastic optimization problem</h2>
<p>Now consider the simplest stochastic optimization problem. A decision maker has to choose an action <span class="math inline">\(a \in \ALPHABET A\)</span>. Upon choosing the action <span class="math inline">\(a\)</span>, the decision maker incurs a cost <span class="math inline">\(c(a,W)\)</span>, where <span class="math inline">\(W \in \ALPHABET W\)</span> is a random variable with known probability distribution. Assume that the decision maker is <em>risk neutral</em> and, therefore, wants to minimize <span class="math inline">\(\EXP[ c(a, W) ]\)</span>, where the expectation is with respect to the random variable&nbsp;<span class="math inline">\(W\)</span>.</p>
<p>Formally, the above optimization problem may be written as <span class="math display">\[\begin{equation} \label{eq:stochastic}
  \min_{a \in \ALPHABET A} \EXP[ c(a, W) ].
\end{equation}\]</span></p>
<p>Define <span class="math inline">\(J(a) = \EXP[ c(a, W) ]\)</span>. Then Problem&nbsp;\eqref{eq:stochastic} is conceptually the same as Problem&nbsp;\eqref{eq:basic} with the cost function <span class="math inline">\(J(a)\)</span>. Numerically, Problem \eqref{eq:stochastic} is more difficult because computing <span class="math inline">\(J(a)\)</span> involves evaluating an expectation, but we ignore the computational complexity for the time being.</p>
</section>
<section id="key-simplifying-idea" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="key-simplifying-idea"><span class="header-section-number">1.2</span> Key simplifying idea</h2>
<p>In the stochastic optimization problems considered above, the decision maker does not observe any data before making a decision. In many situations, the decision maker does observe some data, which is captured by the following model. Suppose a decision maker observes a random variable <span class="math inline">\(S
\in \ALPHABET S\)</span> and then chooses an action <span class="math inline">\(A \in \ALPHABET A\)</span> as a function of his observation according to a <em>decision rule</em> <span class="math inline">\(π\)</span>, i.e., <span class="math display">\[ A = π(S). \]</span></p>
<p>Upon choosing the action <span class="math inline">\(A\)</span>, the decision maker incurs a cost <span class="math inline">\(c(S,A,W)\)</span>, where <span class="math inline">\(W \in \ALPHABET W\)</span> is a random variable. We assume that the <em>primitive random variables</em> <span class="math inline">\((S,W)\)</span> are defined on a common probability space and have a known joint distribution. Assume that the decision maker is risk neutral and, therefore, wants to minimize <span class="math inline">\(\EXP[ c(S, π(S), W)]\)</span>, where the expectation is taken with respect to the joint probability distribution of <span class="math inline">\((S,W)\)</span>.</p>
<p>Formally, the above optimization problem may be written as <span class="math display">\[\begin{equation} \label{eq:obs} \tag{P1}
  \min_{π \colon \ALPHABET S \to \ALPHABET A} \EXP[ c(S, π(S), W) ].
\end{equation}\]</span></p>
<p>Define <span class="math inline">\(J(π) = \EXP[ c(S, π(S), W) ]\)</span>. Then, Problem&nbsp;\eqref{eq:obs} is conceptually the same as Problem&nbsp;\eqref{eq:basic} with one difference: In Problem&nbsp;\eqref{eq:basic}, the minimization is over a parameter <span class="math inline">\(a\)</span>, while in Problem&nbsp;\eqref{eq:obs}, the minimization is over a function <span class="math inline">\(π\)</span>.</p>
<p>When <span class="math inline">\(\ALPHABET S\)</span> and <span class="math inline">\(\ALPHABET A\)</span> are finite sets, the optimal policy can be obtained by an exhaustive search over all policies as follows: for each policy <span class="math inline">\(π\)</span> compute the performance <span class="math inline">\(J(π)\)</span> and then pick the policy <span class="math inline">\(π\)</span> with the smallest expected cost.</p>
<p>Such an exhaustive search is not satisfying for two reasons. First, it has a high computational cost. There are <span class="math inline">\(| \ALPHABET A |^{| \ALPHABET S |}\)</span> policies and, for each policy, we have to evaluate an expectation, which can be expensive. Second, the above enumeration procedure does not work when <span class="math inline">\(\ALPHABET S\)</span> or <span class="math inline">\(\ALPHABET A\)</span> are continuous sets.</p>
<p>There is an alternative way of viewing the problem that simplifies it considerably. Instead of viewing the optimization problem before the system starts running (i.e., the <em>ex ante</em> view), imagine that the decision maker waits until they see the realization <span class="math inline">\(s\)</span> of <span class="math inline">\(S\)</span> (i.e., the <em>interim view</em>). they then asks what action <span class="math inline">\(a\)</span> should they take to minimize the expected <em>conditional</em> cost <span class="math inline">\(Q(s,a) := \EXP[ c(s,a, W) | S = s]\)</span>, i.e., they consider the problem</p>
<p><span class="math display">\[\begin{equation} \label{eq:cond-1} \tag{P2}
  \min_{a \in \ALPHABET A} \EXP[ c(s,a,W) | S = s], \quad
  \forall s \in \ALPHABET S.
\end{equation}\]</span></p>
<p>Thus, Problem&nbsp;\eqref{eq:obs}, which is a functional optimization problem, has been reduced to a collection of parameter optimization problems (Problem&nbsp;\eqref{eq:cond-1}), one for each possible of <span class="math inline">\(s\)</span>.</p>
<p>Now define <span class="math display">\[ \begin{equation} \label{eq:cond} \tag{P2-policy}
  π^∘(s) = \arg \min_{a \in \ALPHABET A} \EXP[ c(s,a, W) | S = s]
\end{equation} \]</span> where ties (in the minimization) are broken arbitrarily.</p>
<div id="thm-fact" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1.1</strong></span> The decision rule <span class="math inline">\(π^∘\)</span> defined in \eqref{eq:cond} is optimal for Problem <span class="math inline">\(\eqref{eq:obs}\)</span>, i.e., <span class="math display">\[
  \min_{π \colon \ALPHABET S \to \ALPHABET A} \EXP[ c(S, π(S), W) ].
  =
  \EXP \biggl[ \min_{a \in \ALPHABET A} \EXP[ c(S,a,W) | S ] \biggr]
  .
\]</span></p>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Remark
</div>
</div>
<div class="callout-body-container callout-body">
<p>We restricted the proof to finite <span class="math inline">\(\ALPHABET S\)</span>, <span class="math inline">\(\ALPHABET A\)</span>, <span class="math inline">\(\ALPHABET W\)</span>. This is to avoid any measurability issues. If <span class="math inline">\(\ALPHABET S\)</span> and <span class="math inline">\(\ALPHABET A\)</span> are continuous sets, we need to restrict to <em>measurable</em> <span class="math inline">\(π\)</span> in Problem <span class="math inline">\(\eqref{eq:obs}\)</span> (otherwise the expectation is not well defined; of course the cost <span class="math inline">\(c\)</span> also has to be measurable). However, it is not immediately obvious that <span class="math inline">\(π^∘\)</span> defined in \eqref{eq:cond} is measurable. Conditions that ensure this are known as <em>measurable selection theorems</em>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(π\)</span> be any other decision rule. Then, <span class="math display">\[ \begin{align*}
  \EXP[ c(S, π(S), W) ] &amp;\stackrel{(a)}= \EXP[ \EXP[c(S, π(S), W) | S ] ] \\
  &amp;\stackrel{(b)}\ge \EXP[\EXP[ c(S, π^∘(S), W) | S ] ] \\
  &amp;\stackrel{(c)}= \EXP[ c(S, π^∘(S), W) ],
\end{align*} \]</span> where <span class="math inline">\((a)\)</span> and <span class="math inline">\((c)\)</span> follow from the law of iterated expectations and <span class="math inline">\((b)\)</span> follows from the definition of <span class="math inline">\(π^∘\)</span> in \eqref{eq:cond}.</p>
</div>
</div>
</div>
<p>We can also provide a partial converse of <a href="#thm-fact" class="quarto-xref">Theorem&nbsp;<span>1.1</span></a>.</p>
<div id="thm-converse" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1.2</strong></span> If <span class="math inline">\(\PR(S = s) &gt; 0\)</span> for all <span class="math inline">\(s\)</span>, then any optimal policy <span class="math inline">\(π^∘\)</span> for Problem&nbsp;<span class="math inline">\(\eqref{eq:obs}\)</span> must satisfy&nbsp;<span class="math inline">\(\eqref{eq:cond}\)</span>.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We prove this by contradiction. Suppose <span class="math inline">\(π^*\)</span> is an optimal policy that does not satisfy \eqref{eq:cond}. By definition of <span class="math inline">\(π^∘\)</span>, it must be the case that for all states <span class="math display">\[\begin{equation}
   \EXP[ c(s, π^∘(s), W) | S = s ]
   \le
   \EXP[ c(s, π^*(s), W) | S = s ] .
   \label{eq:ineq:1}
\end{equation}\]</span> Now, since <span class="math inline">\(π^*\)</span> does not satisfy \eqref{eq:cond}, there exists some state <span class="math inline">\(s^∘ \in \ALPHABET S\)</span> such that <span class="math display">\[\begin{equation}
   \EXP[ c(s^∘, π^*(s^∘), W) | S = s^∘ ]
   &gt;
   \EXP[ c(s^∘, π^∘(s^∘), W) | S = s^∘ ] .
   \label{eq:ineq:2}
\end{equation}\]</span> Therefore, <span class="math display">\[\begin{align*}
   \EXP[ c(S, π^*(S), W) ]
   &amp;=
   \sum_{s \in \ALPHABET S} \PR(S = s)
   \EXP[ \EXP[ c(s, π^*(s), W) | S = s ] ]
   \\
   &amp; \stackrel{(a)}&gt;
   \sum_{s \in \ALPHABET S} \PR(S = s)
   \EXP[ \EXP[ c(s, π^∘(s), W) | S = s ] ]
   \\
   &amp;=
   \EXP[ c(S, π^∘(S), W) ]
\end{align*}\]</span> where <span class="math inline">\((a)\)</span> follows from \eqref{eq:ineq:1} and \eqref{eq:ineq:2} and the inequality is strict becase <span class="math inline">\(\PR(S = s^∘) &gt; 0\)</span>. Thus, <span class="math inline">\(J(π^*) &gt; J(π^∘)\)</span> and, hence, <span class="math inline">\(π^*\)</span> cannot be an optimal policy.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Some notation
</div>
</div>
<div class="callout-body-container callout-body">
<p>To build up to the notation used in <a href="../mdps/intro.html">MDPs</a>, define <span class="math display">\[
    Q(s,a) \coloneqq E[ c(s,a,W) \mid S = s],
\]</span> which is called the <strong>action-value function.</strong> For any policy <span class="math inline">\(π\)</span>, define <span class="math display">\[
  V^π(s) = Q(s,π(s)),
\]</span> which is called the <strong>value function</strong> of policy <span class="math inline">\(π\)</span>. The value function of the optimal policy is often denoted by <span class="math inline">\(V^*\)</span> and, by definition of optimality, it has the property that for any policy <span class="math inline">\(π\)</span>: <span class="math display">\[
  V^*(s) \le V^π(s),
  \quad \forall s \in \ALPHABET S.
\]</span></p>
</div>
</div>
</section>
<section id="an-example-optimal-policy-in-a-card-game" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="an-example-optimal-policy-in-a-card-game"><span class="header-section-number">1.3</span> An example: optimal policy in a card game</h2>
<p>Consier a gamler playing a stylized version of card game played with a deck of <span class="math inline">\(4\)</span> cards: <span class="math inline">\(\{1,2,3,4\}\)</span>. A dealer deals two cards: one to himself and one to the gabler. The gambler looks at his card, and can decide to take one of two actions: fold or challenge. If the gambler folds, the game is over; if he challenges and has a higher card than the dealer, he wins \$1; if he challenges but has a lower than the dealer, he loses \$1. What is the optimal policy?</p>
<p>We can model this as a stochastic optimization probem. Let <span class="math inline">\(W\)</span> denote the cards dealt, <span class="math inline">\(S\)</span> denote gambler’s card, and <span class="math inline">\(A=0\)</span> denote the fold action and <span class="math inline">\(A=1\)</span> denote the challenge action. Then: <span class="math display">\[
\ALPHABET W = \{(1,2), (1,3), (1,4), (2,1), (2,3), (2,4), (3,1), (3,2), (3,4), (4,1), (4,2), (4,3) \},
\]</span> where the first index denotes the card dealt to the dealer and the second denotes the card dealt to the gabmler. We will assume that each of these outcomes is equally likely.</p>
<p>Note that <span class="math inline">\(\ALPHABET S = \{1,2,3,4\}\)</span> and <span class="math inline">\(\ALPHABET A = \{0,1\}\)</span>. So, a policy <span class="math inline">\(π\)</span> is a mapping from <span class="math inline">\(\ALPHABET S\)</span> to <span class="math inline">\(\ALPHABET A\)</span>, i.e., for each card that could be dealt to the gambler, he needs to decide whether to fold or challenge.</p>
<p>There are <span class="math inline">\(|\ALPHABET S|^{|\ALPHABET A|} = 4^2 = 16\)</span> policies. The performance of a policy <span class="math inline">\(π\)</span> is: <span class="math display">\[
  J(π) = \sum_{(d,s) \in \ALPHABET W} \PR(d,s) c(s, π(s), (d,s))
\]</span> where we are using the variable <span class="math inline">\(d\)</span> to denote the card dealt to the dealer.</p>
<p>Now consider one specific policy: <span class="math inline">\(π = [0, 0, 1, 1]\)</span>, which means that the gambler folds if he gets card 1 or 2 and challenges if he gets card 3 and 4. Then, we have <span class="math display">\[\begin{align*}
  J(π) &amp;=
  \underbrace{\tfrac 1{12} \cdot 0}_{(d,s) = (1,2)}
  +
  \underbrace{\tfrac 1{12} \cdot 1}_{(d,s) = (1,3)}
  +
  \underbrace{\tfrac 1{12} \cdot 1}_{(d,s) = (1,4)}
  \\
  &amp; \quad +
  \underbrace{\tfrac 1{12} \cdot 0}_{(d,s) = (2,1)}
  +
  \underbrace{\tfrac 1{12} \cdot 1}_{(d,s) = (2,3)}
  +
  \underbrace{\tfrac 1{12} \cdot 1}_{(d,s) = (2,4)}
  \\
  &amp; \quad +
  \underbrace{\tfrac 1{12} \cdot 0}_{(d,s) = (3,1)}
  +
  \underbrace{\tfrac 1{12} \cdot 0}_{(d,s) = (3,2)}
  +
  \underbrace{\tfrac 1{12} \cdot 1}_{(d,s) = (3,4)}
  \\
  &amp; \quad +
  \underbrace{\tfrac 1{12} \cdot 0}_{(d,s) = (4,1)}
  +
  \underbrace{\tfrac 1{12} \cdot 0}_{(d,s) = (4,2)}
  +
  \underbrace{\tfrac 1{12} \cdot (-1)}_{(d,s) = (4,3)}
  \\
  &amp;= \tfrac 4{12} = \tfrac 13.
\end{align*}\]</span></p>
<p>A brute force search corresponds to computing the performance of all <span class="math inline">\(16\)</span> policies and picking the one with the best performance.</p>
<p>The alternative way to compute the optimal policy via <span class="math inline">\(\eqref{eq:cond}\)</span> proceeds as follows. First observe that <span class="math display">\[
  Q(s,a) \coloneqq
  \EXP[ c(s,a,W) \mid S = s] = \sum_{ (d,s) \in \ALPHABET W }
  \PR( (d,s) \mid S = s) c(s,a,(d,s)).
\]</span> Moreover, <span class="math inline">\(Q(s,0)\)</span> is always <span class="math inline">\(0\)</span>. So, we just need to compute <span class="math inline">\(Q(s,1)\)</span> and check if it is larger or smaller than <span class="math inline">\(0\)</span>.</p>
<ul>
<li><span class="math inline">\(Q(1,1) = \tfrac 13 \bigl[ -1 -1 -1 \bigr] = -1 &lt; 0\)</span>.</li>
<li><span class="math inline">\(Q(2,1) = \tfrac 13[1 -1 -1] = -\tfrac 13 &lt; 0\)</span>.</li>
<li><span class="math inline">\(Q(3,1) = \tfrac 13[1 + 1 -1] = \tfrac 13 &gt; 0\)</span>.</li>
<li><span class="math inline">\(Q(4,1) = \tfrac 13 [ 1 + 1 + 1] = 1 &gt; 0\)</span>.</li>
</ul>
<p>Thus, the optimal policy is <span class="math inline">\(π = [0, 0, 1, 1]\)</span>. We can also verify that <span class="math display">\[
  J(π) = \sum_{s \in \ALPHABET S} \PR(s) Q(s,π(s))
  = \tfrac 14 [ 0 + 0 + \tfrac 13 + 1 ] = \tfrac 13
\]</span> which is the same value that we had obtained by direct computation above.</p>
</section>
<section id="a-tree-representation-of-the-optimization-problem" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="a-tree-representation-of-the-optimization-problem"><span class="header-section-number">1.4</span> A tree representation of the optimization problem</h2>
<p>When all variables <span class="math inline">\((S,W,A)\)</span> are finite valued, the stochastic optimization problem defined above can also be modeled as a tree. Such a tree formulation has two benefits:</p>
<ul>
<li>it provides a geometric view, which can be useful in visualizing the result;</li>
<li>for general, multi-stage problems, it is possible to exploit the tree structure to obtain efficient computation algorithms, see, e.g., <span class="citation" data-cites="Fu2018">Fu (<a href="../references.html#ref-Fu2018" role="doc-biblioref">2018</a>)</span> for an historical overview.</li>
</ul>
<p>There are two ways to construct the tree representation: the first as an one-stage optimization problem with perfect observation and the second as a one-stage optimization problem with imperfect observation. The first is simpler and the second is more general. We explain both formulations below.</p>
<section id="one-step-optimization-with-perfect-observation" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="one-step-optimization-with-perfect-observation"><span class="header-section-number">1.4.1</span> One-step optimization with perfect observation</h3>
<p>We will view the model according to the following timing diagram:</p>
<div id="fig-timing1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-timing1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/timing1.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timing1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: Timing diagram for modeling as a one-step optimization problem with perfect observation
</figcaption>
</figure>
</div>
<p>Thus, nature first generate the “state” variable <span class="math inline">\(S\)</span> according to some distribution <span class="math inline">\(P_S\)</span>, agent takes action <span class="math inline">\(A\)</span> according to the policy <span class="math inline">\(π \colon \ALPHABET S \to \ALPHABET A\)</span>, and then nature generates the “disturbance” <span class="math inline">\(W\)</span> according to some distribution <span class="math inline">\(P_{W|S}\)</span>.</p>
<p>We can view this as a tree, shown in <a href="#fig-tree1" class="quarto-xref">Figure&nbsp;<span>1.2</span></a>, where the root note corresponds to moves nature (denoted by <span class="math inline">\(c\)</span> for chance) to generate <span class="math inline">\(S\)</span>, nodes at depth 1 correspond to the moves of the agent (denoted by <span class="math inline">\(d\)</span> for decision maker) to generate <span class="math inline">\(A\)</span>, and nodes at depth 2 correspond to moves of nature to generate <span class="math inline">\(W\)</span>.[^simplify]</p>
<p>[^simplify] For simplicity, we set <span class="math inline">\(W = (D,S)\)</span> and only show <span class="math inline">\(D\)</span> (the card dealt to the dealer) on the tree.</p>
<div id="fig-tree1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tree1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/game-tree1.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tree1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: Tree representation of the one-step optimization problem. Nodes represent the “agent”: nature or decision maker; the edges represent the moves of the agents; and the numbers at the leaf nodes represent the cost <span class="math inline">\(c(s,a,w)\)</span>. The shaded edges represent a policy.
</figcaption>
</figure>
</div>
<p>We can do the calculation to compute the optimal policy on the tree. The calculations proceed by starting at the last level and moving upwards. In particular, at the nodes of depth <span class="math inline">\(2\)</span>, we compute <span class="math inline">\(Q(s,a)\)</span> using: <span class="math display">\[
Q(s,a) = \EXP[ c(s,a,W) \mid S = s]
=
\sum_{w \in \ALPHABET W}P_{W|S}(w|s) c(s,a,w)
\]</span> If we are given a policy <span class="math inline">\(π\)</span> (like the policy shown by yellow shaded edges in <a href="#fig-tree1" class="quarto-xref">Figure&nbsp;<span>1.2</span></a>), we can compute <span class="math inline">\(V^π(s)\)</span> using: <span class="math display">\[
  V^π(s) = Q(s,π(s)).
\]</span> We can also compute the optimal value function <span class="math inline">\(V^*(s)\)</span> using <span class="math display">\[
  V^*(s) = \min_{a \in \ALPHABET A}Q(s,a)
\]</span> where the optimal policy is given by <span class="math display">\[
  π^*(s) \in \arg\min_{a \in \ALPHABET A}Q(s,a).
\]</span></p>
<p>These calculations are the same as we did in the previous section; the tree simply helps in visualizing what is going on.</p>
</section>
<section id="one-step-optimization-with-imperfect-observation" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="one-step-optimization-with-imperfect-observation"><span class="header-section-number">1.4.2</span> One-step optimization with imperfect observation</h3>
<p>In this case, we will view the model according to the following timing diagram:</p>
<div id="fig-timing2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-timing2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/timing2.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timing2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.3: Timing diagram for modeling as a one-step optimization problem with imperfect observation
</figcaption>
</figure>
</div>
<p>We can view this as a tree, shown in <a href="#fig-tree2" class="quarto-xref">Figure&nbsp;<span>1.4</span></a>, where the root note corresponds to moves nature to generate <span class="math inline">\((S,W)\)</span>, nodes at depth 1 correspond to the moves of the agent to generate <span class="math inline">\(A\)</span>.</p>
<div id="fig-tree2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tree2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/game-tree2.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tree2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.4: Tree representation of the one-step optimization problem. Nodes represent the “agent”: nature or decision maker; the edges represent the moves of the agents; and the numbers at the leaf nodes represent the cost <span class="math inline">\(c(s,a,w)\)</span>. The shaded edges represent a policy.
</figcaption>
</figure>
</div>
<p>In this case, the decision maker cannot distinguish between multiple moves of nature. For example, for <span class="math inline">\(W \in \{ (2,1), (3,1), (4,1) \}\)</span>, the decision maker gets the same observation <span class="math inline">\(S=1\)</span>. This is indicated in the tree diagram by drawing an <strong>information set</strong> around these three nodes, and ensuring that the action taken at these nodes is identical.</p>
<p>In this formulation, the decision maker has imperfect observation of nature’s move. After making an observation, it forms a <em>posterior belief</em> on the state of nature. For example, <span class="math display">\[
  \PR(W | S = 1) =
  \begin{cases}
    \tfrac 13, &amp; \hbox{if } W \in \{(2,1), (3,1), (4,1) \} \\
    0, &amp; \hbox{otherwise}
  \end{cases}
\]</span> The agent then computes <span class="math inline">\(Q(s,a)\)</span> by averaging over this belief: <span class="math display">\[
  Q(s,a) = \sum_{w \in \ALPHABET W} \PR(w|s) c(s,a,w).
\]</span> The value functions <span class="math inline">\(V^π(s)\)</span> and <span class="math inline">\(V^*(s)\)</span> and then computed exactly as before.</p>
<p>The difference between the two approaches is conceptual. For the one-step optimization problen, the actual mathematical calculations done in both formulations are the same. When we go to multi-stage optimization problem, we will see that perfect and imperfect observation models behave very differently.</p>
</section>
</section>
<section id="blackwells-principle-of-irrelevant-information" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="blackwells-principle-of-irrelevant-information"><span class="header-section-number">1.5</span> Blackwell’s principle of irrelevant information</h2>
<p>In many scenarios, the decision maker may observe data which is irrelevant for evaluating performance. In such instances, the decision maker may ignore such information without affecting performance. Formally, we have the following result, which is known as <strong>Blackwell’s principle of irrelevant information</strong>.</p>
<div id="thm-blackwell" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1.3 (Blackwell’s principle of irrelevant information)</strong></span> Let <span class="math inline">\(\ALPHABET S\)</span>, <span class="math inline">\(\ALPHABET Y\)</span>, <span class="math inline">\(\ALPHABET W\)</span>, and <span class="math inline">\(\ALPHABET A\)</span> be standard Borel spaces and <span class="math inline">\(S \in \ALPHABET S\)</span>, <span class="math inline">\(Y \in \ALPHABET Y\)</span>, <span class="math inline">\(W \in
\ALPHABET W\)</span> be random variables defined on a common probability space.</p>
<p>A decision maker observes <span class="math inline">\((S,Y)\)</span> and chooses <span class="math inline">\(A = π(S,Y)\)</span> to minimize <span class="math inline">\(\EXP[c(S,A,W)]\)</span>, where <span class="math inline">\(c \colon \ALPHABET S \times \ALPHABET A \times
\ALPHABET W \to \reals\)</span> is a measurable function.</p>
<p><strong>Then, if <span class="math inline">\(W\)</span> is conditionally independent of <span class="math inline">\(Y\)</span> given <span class="math inline">\(S\)</span>, then there is no loss of optimality in choosing <span class="math inline">\(A\)</span> only as a function of <span class="math inline">\(S\)</span>.</strong></p>
<p>Formally, there exists a <span class="math inline">\(π^* \colon \ALPHABET S \to \ALPHABET A\)</span> such that for all <span class="math inline">\(π \colon \ALPHABET S \times \ALPHABET Y \to \ALPHABET A\)</span>, <span class="math display">\[ \EXP[c(S, π^*(S), W)] \le \EXP[ c(S, π(S,Y), W) ]. \]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We prove the result for the case when <span class="math inline">\(\ALPHABET S\)</span>, <span class="math inline">\(\ALPHABET Y\)</span>, <span class="math inline">\(\ALPHABET
W\)</span>, <span class="math inline">\(\ALPHABET A\)</span> are finite.</p>
<p>Define <span class="math display">\[π^*(s) = \arg \min_{a \in \ALPHABET A} \EXP[ c(s,a, W) | S = s]. \]</span> Then, by construction, for any <span class="math inline">\(s \in \ALPHABET S\)</span> and <span class="math inline">\(a \in \ALPHABET A\)</span>, we have that <span class="math display">\[ \EXP[ c(s, π^*(s), W ) | S = s]  \le \EXP[ c(s,a,W) | S = s]. \]</span> Hence, for any <span class="math inline">\(π \colon \ALPHABET S \times \ALPHABET Y \to \ALPHABET A\)</span>, and for any <span class="math inline">\(s \in \ALPHABET S\)</span> and <span class="math inline">\(y \in \ALPHABET Y\)</span>, we have <span class="math display">\[ \begin{equation} \label{eq:opt}
  \EXP[ c(s, π^*(s), W) | S = s] \le \EXP[ c(s, π(s,y),W) | S = s].
\end{equation} \]</span> The result follows by taking the expectation of both sides of \eqref{eq:opt}.</p>
</div>
</div>
</div>
<p>The above proof doesn’t work for general Borel spaces because <span class="math inline">\(π^*\)</span> defined above may not exist (inf vs min) or may not be measurable. See <span class="citation" data-cites="Blackwell1964">Blackwell (<a href="../references.html#ref-Blackwell1964" role="doc-biblioref">1964</a>)</span> for a formal proof.</p>
</section>
<section id="exercises" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="exercises">Exercises</h2>
<div id="exr-stoc-optim-computing" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.1 (Computing optimal policies)</strong></span> Suppose <span class="math inline">\(\ALPHABET S = \{1, 2 \}\)</span>, <span class="math inline">\(\ALPHABET A = \{1, 2, 3\}\)</span>, and <span class="math inline">\(\ALPHABET
W = \{1, 2, 3\}\)</span>. Let <span class="math inline">\((S,W)\)</span> be random variables taking values in <span class="math inline">\(\ALPHABET S × \ALPHABET W\)</span> with joint distribution <span class="math inline">\(P\)</span> shown below.</p>
<p><span class="math display">\[ P = \MATRIX{ 0.25 &amp; 0.15 &amp; 0.05  \\ 0.30 &amp; 0.10 &amp; 0.15 } \]</span></p>
<p>Here the row corresponds to the value of <span class="math inline">\(s\)</span> and the column corresponds to the value of <span class="math inline">\(w\)</span>. For example <span class="math inline">\(\PR(S=2, W=1) = P_{21} = 0.30\)</span>.</p>
<p>The cost function <span class="math inline">\(c \colon \ALPHABET S \times \ALPHABET A \times \ALPHABET
W \to \reals\)</span> is shown below</p>
<p><span class="math display">\[
c(\cdot,\cdot,1) = \MATRIX{3 &amp; 5 &amp; 1 \\ 2 &amp; 3 &amp; 1 }, \quad
c(\cdot,\cdot,2) = \MATRIX{4 &amp; 3 &amp; 1 \\ 1 &amp; 2 &amp; 8 }, \quad
c(\cdot,\cdot,3) = \MATRIX{1 &amp; 2 &amp; 2 \\ 4 &amp; 1 &amp; 3 }.
\]</span></p>
<p>Here the row corresponds to the value of <span class="math inline">\(s\)</span> and the column corresponds to the value of <span class="math inline">\(a\)</span>. For example <span class="math inline">\(c(s=1,a=2,w=1) = 5\)</span>.</p>
<p>Find the policy <span class="math inline">\(π \colon \ALPHABET S \to \ALPHABET A\)</span> that minimizes <span class="math inline">\(\EXP[ c(S, π(S), W) ]\)</span>.</p>
</div>
<div id="exr-stoc-optim-blackwell" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.2 (Blackwell’s principle)</strong></span> Suppose <span class="math inline">\(\ALPHABET S = \{1, 2\}\)</span>, <span class="math inline">\(\ALPHABET Y = \{1, 2\}\)</span>, <span class="math inline">\(\ALPHABET A =
\{1, 2, 3\}\)</span>, and <span class="math inline">\(\ALPHABET W = \{1, 2, 3\}\)</span>. Let <span class="math inline">\((S,Y,W)\)</span> be random variables taking values in <span class="math inline">\(\ALPHABET S × \ALPHABET Y × \ALPHABET W\)</span>, with joint distribution <span class="math inline">\(P\)</span> shown below. <span class="math display">\[
P_{Y = 1} = \MATRIX{0.15 &amp; 0.10 &amp; 0.00 \\ 0.15 &amp; 0.05 &amp; 0.10}
\qquad
P_{Y = 2} = \MATRIX{0.10 &amp; 0.05 &amp; 0.05 \\ 0.15 &amp; 0.05 &amp; 0.05}
\]</span> For a fixed value of <span class="math inline">\(y\)</span>, the row corresponds to the value of <span class="math inline">\(s\)</span> and the column corresponds to the value of <span class="math inline">\(w\)</span>. For example <span class="math inline">\(\PR(S = 1, Y = 1, W = 3) = 0\)</span>. Note that the joint distribution of <span class="math inline">\((S,Y,W)\)</span> is such that the margin on <span class="math inline">\((S,W)\)</span> is the same as the distribution on <span class="math inline">\((S,W)\)</span> given in the previous exercise (<a href="#exr-stoc-optim-computing" class="quarto-xref">Exercise&nbsp;<span>1.1</span></a>).</p>
<p>The cost function <span class="math inline">\(c \colon \ALPHABET S × \ALPHABET A × \ALPHABET W \to
\reals\)</span> is the same as the previous exercise.</p>
<ol type="a">
<li><p>Find the policy <span class="math inline">\(π \colon \ALPHABET S × \ALPHABET Y \to \ALPHABET A\)</span> that minimizes <span class="math inline">\(\EXP[c(S, π(S,Y), W)]\)</span>.</p></li>
<li><p>Compare the solution with the solution of the previous exercise (<a href="#exr-stoc-optim-computing" class="quarto-xref">Exercise&nbsp;<span>1.1</span></a>) in view of Blackwell’s principle of irrelevant information. Clearly explain your observations.</p></li>
<li><p>Repeat the above exercise with the following joint distribution: <span class="math display">\[
P_{Y = 1} = \MATRIX{0.20 &amp; 0.12 &amp; 0.04 \\ 0.24 &amp; 0.08 &amp; 0.12}
\qquad
P_{Y = 2} = \MATRIX{0.05 &amp; 0.03 &amp; 0.01 \\ 0.06 &amp; 0.02 &amp; 0.03}
\]</span></p></li>
</ol>
</div>
<!-- From page 172 of Whittle, Optimal Control: Basics and Beyond -->
<div id="exr-stoc-optim-pollution-monitoring" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.3 (Pollution monitoring)</strong></span> Consider the problem of monitoring the pollution level of a river. The river can have a high pollution level if there is a catastrophic failure of a factory upstream. There are then two “pollution states” indicating whether such a failure has occured. We denote them by <span class="math inline">\(W = 0\)</span> (indicating no failure) and <span class="math inline">\(W = 1\)</span> (indicating catastrophic failure). Let <span class="math inline">\([p, 1-p]\)</span> denote the prior probability mass function of <span class="math inline">\(W\)</span>.</p>
<p>The pollution monitoring system has a sensor which takes a measurement <span class="math inline">\(s\)</span> of the pollution level. Let <span class="math inline">\(f_w(s)\)</span> denote the probabiity density of the observation <span class="math inline">\(s\)</span> conditional on the value of <span class="math inline">\(w\)</span>, <span class="math inline">\(w \in \{0, 1\}\)</span>. Two actions are available at the monitoring system: raise an alarm or not raise an alarm. The cost of raising the alarm is <span class="math inline">\(C_0\)</span> if the state <span class="math inline">\(W\)</span> is <span class="math inline">\(0\)</span> or zero if the state <span class="math inline">\(W\)</span> is <span class="math inline">\(1\)</span>; the cost of not raising the alarm is zero if the state <span class="math inline">\(W\)</span> is <span class="math inline">\(0\)</span> or <span class="math inline">\(C_1\)</span> if the state <span class="math inline">\(W\)</span> is <span class="math inline">\(1\)</span>.</p>
<p>Show that it is optimal to raise the alarm if <span class="math display">\[ p f_0(s) C_0 &lt; (1 - p) f_1(s) C_1. \]</span> That is, it is optimal to raise the alarm if the <strong>likelihood ratio</strong> <span class="math inline">\(f_1(s)/f_0(s)\)</span> exceeds the threshold value <span class="math inline">\(p C_0/(1-p) C_1\)</span>.</p>
</div>
<div id="exr-stoc-optim-pollution-monitoring-cont" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.4 (Pollution monitoring, continued)</strong></span> The decision rule obtain in <a href="#exr-stoc-optim-pollution-monitoring" class="quarto-xref">Exercise&nbsp;<span>1.3</span></a> is of the form: raise the alarm if <span class="math display">\[
    \frac{f_1(s)}{f_0(s)} &gt; τ,
    \quad \hbox{where } τ = \frac{p C_0}{(1-p)C_1}.
\]</span> When the observation density belongs to the <a href="https://en.wikipedia.org/wiki/Exponential_family">:exponential family</a>, it is more convenient to work with the <strong>log-likelihood ratio</strong> <span class="math inline">\(\ALPHABET L(s) \coloneqq \log (f_1(s)/f_0(s))\)</span> and use the test: raise the alarm if <span class="math display">\[
  \ALPHABET L(s) &gt; \log τ.
\]</span> This is called the log-likelihood ratio test (LLRT).</p>
<p>Suppose that the observation density is conditionally Gaussian and is given by: <span class="math display">\[
  f_w(s) = \exp\biggl( - \frac{ (s-w)^2 }{ 2 σ^2 }\biggr)
\]</span> where <span class="math inline">\(σ &gt; 0\)</span> is known. Simplify the LLRT. Does the decision rule intuitively make sense?</p>
</div>
<div id="exr-stoc-optim-stochastic-policies" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.5 (Stochastic/Randomized policies)</strong></span> In the discussion above, we have assumed that decision rule <span class="math inline">\(π\)</span> is deterministic. It is also possible to consider stochastic/randomized decision rules: <span class="math inline">\(π \colon \ALPHABET S \to Δ(\ALPHABET A)\)</span>, where the performance of a policy is given by <span class="math display">\[
J(π) = \sum_{s,w \in \ALPHABET S × \ALPHABET W} \sum_{a \in \ALPHABET A}
P(s,w) π(a \mid s) c(s,a,w).
\]</span> Now consider the problem of <span class="math inline">\(\min_{π : \ALPHABET S \to Δ(\ALPHABET A)} J(π)\)</span>. Show that the result of <a href="#thm-fact" class="quarto-xref">Theorem&nbsp;<span>1.1</span></a> remains valid even when we allow stochastic/randomization.</p>
<p><em>Note:</em> This fact is sometimes stated as <em>“randomization does not improve performance”</em>, but is only true for <strong>unconstrained problems</strong>. When constraints are involved, randomization may improve performance.</p>
</div>
</section>
<section id="notes" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="notes">Notes</h2>
<p><a href="#thm-blackwell" class="quarto-xref">Theorem&nbsp;<span>1.3</span></a> is due to <span class="citation" data-cites="Blackwell1964">Blackwell (<a href="../references.html#ref-Blackwell1964" role="doc-biblioref">1964</a>)</span> in a short 2.5 page paper. A similar result was used by <span class="citation" data-cites="Witsenhausen1979">Witsenhausen (<a href="../references.html#ref-Witsenhausen1979" role="doc-biblioref">1979</a>)</span> to show the structure of optimal coding strategies in real-time communication. Also see the <a href="https://infostructuralist.wordpress.com/2010/11/08/deadly-ninja-weapons-blackwells-principle-of-irrelevant-information/">blog post</a> by Maxim Ragisnsky.</p>
<p><a href="#exr-stoc-optim-pollution-monitoring" class="quarto-xref">Exercise&nbsp;<span>1.3</span></a> is adaptive from <span class="citation" data-cites="Whittle1996">Whittle (<a href="../references.html#ref-Whittle1996" role="doc-biblioref">1996</a>)</span>. It is a special instance of Bayesian hypothesis testing problem. We will study a generalization of this model later in <a href="../../pomdp/sequential-hypothesis">sequential hypothesis testing</a></p>
<p>Historically, the tree representation of optimization problems is due to Kuhn <span class="citation" data-cites="Kuhn1950 Kuhn1953">(<a href="../references.html#ref-Kuhn1950" role="doc-biblioref">1950</a>; <a href="../references.html#ref-Kuhn1953" role="doc-biblioref">1953</a>)</span>, who used them to model multi-player multi-stage games.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Blackwell1964" class="csl-entry" role="listitem">
<span class="smallcaps">Blackwell, D.</span> 1964. Memoryless strategies in finite-stage dynamic programming. <em>The Annals of Mathematical Statistics</em> <em>35</em>, 2, 863–865. DOI: <a href="https://doi.org/10.1214/aoms/1177703586">10.1214/aoms/1177703586</a>.
</div>
<div id="ref-Fu2018" class="csl-entry" role="listitem">
<span class="smallcaps">Fu, M.C.</span> 2018. Monte carlo tree search: A tutorial. <em>2018 winter simulation conference (WSC)</em>, IEEE. DOI: <a href="https://doi.org/10.1109/wsc.2018.8632344">10.1109/wsc.2018.8632344</a>.
</div>
<div id="ref-Kuhn1950" class="csl-entry" role="listitem">
<span class="smallcaps">Kuhn, H.W.</span> 1950. Extensive games. <em>Proceedings of the National Academy of Sciences</em> <em>36</em>, 10, 570–576. DOI: <a href="https://doi.org/10.1073/pnas.36.10.570">10.1073/pnas.36.10.570</a>.
</div>
<div id="ref-Kuhn1953" class="csl-entry" role="listitem">
<span class="smallcaps">Kuhn, H.W.</span> 1953. Extensive games and the problem of information. In: H.W. Kuhn and A.W. Tucker, eds., <em>Contributions to the theory of games</em>. Princeton University Press, 193–216.
</div>
<div id="ref-Whittle1996" class="csl-entry" role="listitem">
<span class="smallcaps">Whittle, P.</span> 1996. <em>Optimal control: Basics and beyond</em>. Wiley.
</div>
<div id="ref-Witsenhausen1979" class="csl-entry" role="listitem">
<span class="smallcaps">Witsenhausen, H.S.</span> 1979. On the structure of real-time source coders. <em>Bell System Technical Journal</em> <em>58</em>, 6, 1437–1451.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../index.html" class="pagination-link  aria-label=" about="" the="" course"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">About the course</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../stochastic-optimization/newsvendor.html" class="pagination-link" aria-label="<span class='chapter-number'>2</span>&nbsp; <span class='chapter-title'>The newsvendor problem</span>">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The newsvendor problem</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/adityam/stochastic-control/edit/quarto/stochastic-optimization/intro.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer><script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>